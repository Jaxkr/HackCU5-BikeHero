<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
        integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <title>
        Jubilant-garbanzo
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />


</head>

<body>
    <div id="bitmoji-hint"><i class="fas fa-chevron-up"></i></div>

    <nav style="font-size: 20px;" class="navbar navbar-expand-lg navbar-light bg-trans">
        <a class="navbar-brand" href="#"></a>

        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fas fa-bicycle"></i> Ride</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fas fa-mask"></i> My Bike Hero</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fas fa-map-marker-alt"></i> Destinations</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="bingbang://"><i class="fab fa-snapchat"></i> Snap trip</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#"><i class="fas fa-cogs"></i> Settings</a>
                </li>
            </ul>
        </div>
    </nav>

    <div id="ride-content">
        <div id="bitmoji-container">
            <a class="navbar-toggle" style="width: 100%; height: 100%" data-toggle="collapse"
                data-target="#navbarNav"><img href="" id="bitmoji"></a>
        </div>

        <div class="mapbg">
            <div id='map' style='width: 100%; height: 100vh;'></div>
            <script>
                mapboxgl.accessToken = 'pk.eyJ1IjoiamF4a3IiLCJhIjoiY2pzaHpmcTB2MDg2aDQ0cm9mMTBxbG94NiJ9.Z3MA4WN6-59v2KTPsp6R0Q';
                var map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: [-105.279617, 40.016869],
                    zoom: 15,
                });
            </script>
        </div>
        <div class="buttonbox">

            <button style="display: none" id="startrideb" class="startridebox btn btn-success btn-lg btn-block startridebutton">Start ride</button>
            <div id="my-login-button-target"></div>
            <button id="parentbutton" class="startridebox btn btn-primary btn-lg btn-block startridebutton snapchat-curve">Parent? Set up
                kid account</button>
        </div>

    </div>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>


        $(document).ready(function () {
            console.log(window.location.href);
        });

        var hint_y = 60;
        var hint_delta = .1;

        var animatehint;


        $('#bitmoji-container').click(function () {
            clearInterval(animatehint);
            $('#bitmoji-hint').fadeOut();
        });


        var user_data;

        function handleUserData(data) {
            user_data = data;
            console.log(user_data);
            if ("avatar" in user_data['data']['me']['bitmoji']) {
                $('#bitmoji').attr('src', user_data['data']['me']['bitmoji']['avatar']);
                $('#bitmoji-container').fadeIn();
            } else {
                $('#bitmoji').attr('src', '/images/greyboy.png');
                $('#bitmoji-container').fadeIn();

            }

            animatehint = setInterval(function () {
                $('#bitmoji-hint').css('top', hint_y);
                hint_y += hint_delta;
                if (hint_y < 60) {
                    hint_delta = .1;
                }
                if (hint_y > 75) {
                    hint_delta = -.1;
                }
            }, 10);
            $('#bitmoji-hint').fadeIn();

            $('#my-login-button-target').hide()
            $('#parentaccount').hide();
            $('#startrideb').fadeIn();

        }


        window.snapKitInit = function () {
            var loginButtonIconId = 'my-login-button-target';
            // Mount Login Button
            snap.loginkit.mountButton(loginButtonIconId, {
                clientId: '094eabf7-2f4f-45d8-98d4-ebad958e321e',
                redirectURI: 'https://practical-lamarr-fde8bc.netlify.com/',
                scopeList: [
                    'user.display_name',
                    'user.bitmoji.avatar',
                ],
                handleResponseCallback: function () {
                    snap.loginkit.fetchUserInfo()
                        .then(data => handleUserData(data));
                },
            });
        };

        // Load the SDK asynchronously
        (function (d, s, id) {
            var js, sjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "https://sdk.snapkit.com/js/v1/login.js";
            sjs.parentNode.insertBefore(js, sjs);
        }(document, 'script', 'loginkit-sdk'));
    </script>



    <script>
        var pages = ['ride', 'hero', 'destinations', 'snap', 'settings'];
        var currentPage = 0; //index in pages




        function renderPage(pageIndex) {
            switch (pageIndex) {
                case 0:
                    renderRide();
                    break;
                default:
                    alert('This should never ever happen, check the index value you passed to renderPage');
                    break;
            }
        }
        function renderRide() {

        }
    </script>
</body>

</html>